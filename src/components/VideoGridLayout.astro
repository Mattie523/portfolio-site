---
import Layout from '../layouts/Layout.astro';
import { Image } from 'astro:assets';

interface Props {
	videos: any[];
	currentCategory?: string;
}

const { videos, currentCategory } = Astro.props;
const currentPath = Astro.url.pathname;
---

<Layout>
	<div class="max-w-7xl mx-auto p-4 md:p-8">
		<h2 class="text-3xl font-bold mb-6 dark:text-white">Videography</h2>

		<!-- Sub-navigation -->
		<nav class="mb-8">
			<ul class="flex gap-6 md:gap-8 text-base md:text-lg">
				<li><a href="/videography" class={`hover:text-sage-400 hover:underline decoration-sage-400 transition-colors ${currentPath === '/videography' || currentPath === '/videography/' ? 'text-sage-600 font-bold' : ''}`}>All</a></li>
				<li><a href="/videography/brand-narrative" class={`hover:text-sage-400 hover:underline decoration-sage-400 transition-colors ${currentPath === '/videography/brand-narrative' || currentPath === '/videography/brand-narrative/' ? 'text-sage-600 font-bold' : ''}`}>Brand & Narrative</a></li>
				<li><a href="/videography/awards-recognition" class={`hover:text-sage-400 hover:underline decoration-sage-400 transition-colors ${currentPath === '/videography/awards-recognition' || currentPath === '/videography/awards-recognition/' ? 'text-sage-600 font-bold' : ''}`}>Awards & Recognition</a></li>
				<li><a href="/videography/insights" class={`hover:text-sage-400 hover:underline decoration-sage-400 transition-colors ${currentPath === '/videography/insights' || currentPath === '/videography/insights/' ? 'text-sage-600 font-bold' : ''}`}>Insights</a></li>
			</ul>
		</nav>

		<section class="isolate">
			<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
				{videos.map((video) => (
					<a href={currentCategory ? `/videography/${currentCategory}/${video.slug}` : `/videography/${video.slug}`} class="overflow-hidden rounded-lg cursor-pointer group shadow-lg hover:shadow-sage-400/50 hover:shadow-2xl transition-shadow">
						<div class="aspect-video relative" transition:name={`video-${video.slug}`}>
							{video.type === 'youtube' && video.poster && (
								<Image
									src={`/thumbnails/${video.poster}`}
									alt={video.title}
									width={1280}
									height={720}
									class="w-full h-full object-cover transition-transform duration-500 ease-out group-hover:scale-105"
								/>
							)}
							{video.type === 'youtube' && !video.poster && (
								<Image
									src={`https://img.youtube.com/vi/${video.videoId}/maxresdefault.jpg`}
									alt={video.title}
									width={1280}
									height={720}
									class="w-full h-full object-cover transition-transform duration-500 ease-out group-hover:scale-105"
								/>
							)}
							{video.type === 'vimeo' && video.poster && (
								<Image
									src={`/thumbnails/${video.poster}`}
									alt={video.title}
									width={1280}
									height={720}
									class="w-full h-full object-cover transition-transform duration-500 ease-out group-hover:scale-105"
								/>
							)}
							{video.type === 'vimeo' && !video.poster && (
								<div class="w-full h-full bg-gray-300 dark:bg-stone-700 flex items-center justify-center">
									<svg class="w-16 h-16 text-gray-500" fill="currentColor" viewBox="0 0 24 24">
										<path d="M8 5v14l11-7z"/>
									</svg>
								</div>
							)}
							{video.type === 'local' && video.poster && (
								<Image
									src={`/thumbnails/${video.poster}`}
									alt={video.title}
									width={1280}
									height={720}
									class="w-full h-full object-cover transition-transform duration-500 ease-out group-hover:scale-105"
								/>
							)}
							{video.type === 'local' && !video.poster && (
								<div class="w-full h-full bg-gray-300 dark:bg-stone-700 flex items-center justify-center">
									<svg class="w-16 h-16 text-gray-500" fill="currentColor" viewBox="0 0 24 24">
										<path d="M8 5v14l11-7z"/>
									</svg>
								</div>
							)}
							<div class="absolute inset-0 flex items-center justify-center">
								<div class="w-16 h-16 bg-black/60 rounded-full flex items-center justify-center">
									<svg class="w-8 h-8 text-white ml-1" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
										<path d="M8 5v14l11-7z"/>
									</svg>
								</div>
							</div>
							<div class="absolute bottom-0 left-0 right-0 bg-black/70 p-4 md:opacity-0 md:group-hover:opacity-100 transition-opacity">
								<h3 class="font-semibold text-white">{video.title}</h3>
								{video.role && (
									<p class="text-sm text-gray-300 mt-1">{video.role}</p>
								)}
							</div>
						</div>
					</a>
				))}
			</div>
		</section>
	</div>
</Layout>
